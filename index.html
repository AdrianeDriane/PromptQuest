<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fireboy & Watergirl: Rising Flood</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .game-canvas {
        background: linear-gradient(135deg, #2c1810 0%, #1a0f08 100%);
        position: relative;
        overflow: hidden;
      }

      .character {
        position: absolute;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        transition: all 0.1s ease;
        z-index: 10;
        object-fit: contain;
         transform: translateY(-16px);
      }

      .fireboy {
      }

      .watergirl {
        background: radial-gradient(circle, #4fc3f7 0%, #1976d2 100%);
        box-shadow: 0 0 20px rgba(79, 195, 247, 0.6);
      }

      .platform {
        position: absolute;
        background: #8d6e63;
        border: 2px solid #5d4037;
      }

      .lava-pool {
        position: absolute;
        background: linear-gradient(45deg, #ff5722, #d32f2f);
        border-radius: 8px;
        animation: lava-glow 2s ease-in-out infinite alternate;
      }

      .water-pool {
        position: absolute;
        background: linear-gradient(45deg, #2196f3, #0d47a1);
        border-radius: 8px;
        animation: water-glow 2s ease-in-out infinite alternate;
      }

      .poison-pool {
        position: absolute;
        background: linear-gradient(45deg, #4caf50, #1b5e20);
        border-radius: 8px;
        animation: poison-glow 2s ease-in-out infinite alternate;
      }

      @keyframes lava-glow {
        0% {
          box-shadow: 0 0 20px rgba(255, 87, 34, 0.8);
        }
        100% {
          box-shadow: 0 0 40px rgba(255, 87, 34, 1);
        }
      }

      @keyframes water-glow {
        0% {
          box-shadow: 0 0 20px rgba(33, 150, 243, 0.8);
        }
        100% {
          box-shadow: 0 0 40px rgba(33, 150, 243, 1);
        }
      }

      @keyframes poison-glow {
        0% {
          box-shadow: 0 0 20px rgba(76, 175, 80, 0.8);
        }
        100% {
          box-shadow: 0 0 40px rgba(76, 175, 80, 1);
        }
      }

      .door {
        position: absolute;
        width: 40px;
        height: 60px;
        border-radius: 20px 20px 0 0;
        border: 3px solid;
      }

      .fire-door {
        background: linear-gradient(180deg, #ff8a65, #d32f2f);
        border-color: #ff5722;
        box-shadow: 0 0 30px rgba(255, 87, 34, 0.8);
      }

      .water-door {
        background: linear-gradient(180deg, #64b5f6, #1976d2);
        border-color: #2196f3;
        box-shadow: 0 0 30px rgba(33, 150, 243, 0.8);
      }

      .flood {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(
          0deg,
          #0d47a1 0%,
          #1976d2 50%,
          rgba(25, 118, 210, 0.3) 100%
        );
        transition: height 0.5s ease;
        z-index: 5;
        animation: wave 3s ease-in-out infinite;
      }

      @keyframes wave {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      .gem {
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        z-index: 8;
        animation: sparkle 1.5s ease-in-out infinite alternate;
      }

      .fire-gem {
        background: radial-gradient(circle, #ffeb3b, #ff5722);
        box-shadow: 0 0 15px rgba(255, 235, 59, 0.8);
      }

      .water-gem {
        background: radial-gradient(circle, #e1f5fe, #2196f3);
        box-shadow: 0 0 15px rgba(225, 245, 254, 0.8);
      }

      @keyframes sparkle {
        0% {
          transform: scale(1) rotate(0deg);
        }
        100% {
          transform: scale(1.2) rotate(180deg);
        }
      }
    </style>
  </head>
  <body class="bg-gray-900 text-white">
    <div class="container mx-auto px-4 py-8">
      <div class="text-center mb-4">
        <h1
          class="text-4xl font-bold mb-2 bg-gradient-to-r from-red-500 to-blue-500 bg-clip-text text-transparent"
        >
          Fireboy & Watergirl: Rising Flood
        </h1>
        <div class="flex justify-center gap-8 mb-4">
          <div class="text-red-400">
            <span class="font-bold">Fireboy:</span> WASD to move
          </div>
          <div class="text-blue-400">
            <span class="font-bold">Watergirl:</span> Arrow keys to move
          </div>
        </div>
        <div class="flex justify-center gap-4 text-sm">
          <div>Level: <span id="level" class="font-bold">1</span></div>
          <div>Gems: <span id="gems" class="font-bold">0/4</span></div>
          <div>
            Flood Height: <span id="flood-height" class="font-bold">0%</span>
          </div>
        </div>
      </div>

      <div
        id="game-canvas"
        class="game-canvas mx-auto"
        style="width: 800px; height: 600px"
      >
        <!-- Characters -->
        <img id="fireboy" src="./src/images/vico_sotto.png" class="character fireboy"></img>
        <div id="watergirl" class="character watergirl"></div>

        <!-- Flood -->
        <div id="flood" class="flood" style="height: 0px"></div>

        <!-- Game objects will be dynamically added here -->
      </div>

      <div class="text-center mt-4">
        <div id="game-status" class="text-lg font-bold mb-2"></div>
        <button
          id="restart-btn"
          class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-bold transition-colors"
        >
          Restart Level
        </button>
      </div>
    </div>

    <script>
      class Game {
        constructor() {
          this.canvas = document.getElementById("game-canvas");
          this.fireboy = document.getElementById("fireboy");
          this.watergirl = document.getElementById("watergirl");
          this.flood = document.getElementById("flood");

          this.level = 1;
          this.gems = { collected: 0, total: 4 };
          this.floodHeight = 0;
          this.floodRiseSpeed = 0.5;
          this.gameRunning = true;

          this.characters = {
            fireboy: {
              x: 50,
              y: 520,
              width: 32,
              height: 32,
              onGround: false,
              velY: 0,
            },
            watergirl: {
              x: 100,
              y: 520,
              width: 32,
              height: 32,
              onGround: false,
              velY: 0,
            },
          };

          this.keys = {};
          this.gravity = 0.8;
          this.jumpPower = 15;
          this.moveSpeed = 5;

          this.platforms = [];
          this.pools = [];
          this.doors = [];
          this.gameGems = [];

          this.init();
        }

        init() {
          this.setupEventListeners();
          this.createLevel();
          this.gameLoop();
          this.floodTimer();
        }

        setupEventListeners() {
          document.addEventListener("keydown", (e) => {
            this.keys[e.key.toLowerCase()] = true;
          });

          document.addEventListener("keyup", (e) => {
            this.keys[e.key.toLowerCase()] = false;
          });

          document
            .getElementById("restart-btn")
            .addEventListener("click", () => {
              this.restart();
            });
        }

        createLevel() {
          this.clearLevel();

          // Create platforms
          this.createPlatform(0, 580, 800, 20); // Ground
          this.createPlatform(200, 480, 150, 20);
          this.createPlatform(450, 380, 150, 20);
          this.createPlatform(100, 350, 100, 20);
          this.createPlatform(600, 450, 100, 20);
          this.createPlatform(300, 250, 200, 20);
          this.createPlatform(650, 300, 100, 20);
          this.createPlatform(50, 200, 120, 20);

          // Create pools
          this.createPool("lava", 160, 560, 80, 20);
          this.createPool("water", 350, 560, 80, 20);
          this.createPool("poison", 500, 560, 80, 20);
          this.createPool("lava", 400, 360, 60, 20);
          this.createPool("water", 550, 430, 60, 20);

          // Create doors
          this.createDoor("fire", 680, 240);
          this.createDoor("water", 720, 240);

          // Create gems
          this.createGem("fire", 250, 450);
          this.createGem("water", 500, 350);
          this.createGem("fire", 650, 470);
          this.createGem("water", 320, 220);
        }

        createPlatform(x, y, width, height) {
          const platform = document.createElement("div");
          platform.className = "platform";
          platform.style.left = x + "px";
          platform.style.top = y + "px";
          platform.style.width = width + "px";
          platform.style.height = height + "px";
          this.canvas.appendChild(platform);

          this.platforms.push({ x, y, width, height, element: platform });
        }

        createPool(type, x, y, width, height) {
          const pool = document.createElement("div");
          pool.className = `${type}-pool`;
          pool.style.left = x + "px";
          pool.style.top = y + "px";
          pool.style.width = width + "px";
          pool.style.height = height + "px";
          this.canvas.appendChild(pool);

          this.pools.push({ type, x, y, width, height, element: pool });
        }

        createDoor(type, x, y) {
          const door = document.createElement("div");
          door.className = `door ${type}-door`;
          door.style.left = x + "px";
          door.style.top = y + "px";
          this.canvas.appendChild(door);

          this.doors.push({ type, x, y, width: 40, height: 60, element: door });
        }

        createGem(type, x, y) {
          const gem = document.createElement("div");
          gem.className = `gem ${type}-gem`;
          gem.style.left = x + "px";
          gem.style.top = y + "px";
          this.canvas.appendChild(gem);

          this.gameGems.push({
            type,
            x,
            y,
            width: 20,
            height: 20,
            element: gem,
            collected: false,
          });
        }

        clearLevel() {
          const elements = this.canvas.querySelectorAll(
            ".platform, .lava-pool, .water-pool, .poison-pool, .door, .gem"
          );
          elements.forEach((el) => el.remove());

          this.platforms = [];
          this.pools = [];
          this.doors = [];
          this.gameGems = [];
        }

        updateCharacter(char, charName) {
          // Handle input
          if (charName === "fireboy") {
            if (this.keys["a"]) char.x -= this.moveSpeed;
            if (this.keys["d"]) char.x += this.moveSpeed;
            if (this.keys["w"] && char.onGround) {
              char.velY = -this.jumpPower;
              char.onGround = false;
            }
          } else if (charName === "watergirl") {
            if (this.keys["arrowleft"]) char.x -= this.moveSpeed;
            if (this.keys["arrowright"]) char.x += this.moveSpeed;
            if (this.keys["arrowup"] && char.onGround) {
              char.velY = -this.jumpPower;
              char.onGround = false;
            }
          }

          // Apply gravity
          if (!char.onGround) {
            char.velY += this.gravity;
          }
          char.y += char.velY;

          // Boundary checks
          char.x = Math.max(0, Math.min(char.x, 800 - char.width));

          // Platform collision
          char.onGround = false;
          for (let platform of this.platforms) {
            if (this.checkCollision(char, platform)) {
              if (char.velY > 0 && char.y < platform.y) {
                char.y = platform.y - char.height;
                char.velY = 0;
                char.onGround = true;
              }
            }
          }

          // Pool collision
          for (let pool of this.pools) {
            if (this.checkCollision(char, pool)) {
              if (
                (pool.type === "lava" && charName === "watergirl") ||
                (pool.type === "water" && charName === "fireboy") ||
                pool.type === "poison"
              ) {
                this.gameOver("Game Over! Character touched deadly element!");
                return;
              }
            }
          }

          // Gem collection
          for (let gem of this.gameGems) {
            if (!gem.collected && this.checkCollision(char, gem)) {
              if (
                (gem.type === "fire" && charName === "fireboy") ||
                (gem.type === "water" && charName === "watergirl")
              ) {
                gem.collected = true;
                gem.element.style.display = "none";
                this.gems.collected++;
                this.updateUI();
              }
            }
          }

          // Flood collision
          if (char.y + char.height > 600 - this.floodHeight) {
            this.gameOver("Game Over! Caught by the flood!");
            return;
          }

          // Door collision (win condition)
          for (let door of this.doors) {
            if (this.checkCollision(char, door)) {
              if (
                (door.type === "fire" && charName === "fireboy") ||
                (door.type === "water" && charName === "watergirl")
              ) {
                this.checkWin();
              }
            }
          }
        }

        checkCollision(obj1, obj2) {
          return (
            obj1.x < obj2.x + obj2.width &&
            obj1.x + obj1.width > obj2.x &&
            obj1.y < obj2.y + obj2.height &&
            obj1.y + obj1.height > obj2.y
          );
        }

        checkWin() {
          // Check if both characters are at their doors and all gems collected
          let fireboyAtDoor = false;
          let watergirlAtDoor = false;

          for (let door of this.doors) {
            if (
              door.type === "fire" &&
              this.checkCollision(this.characters.fireboy, door)
            ) {
              fireboyAtDoor = true;
            }
            if (
              door.type === "water" &&
              this.checkCollision(this.characters.watergirl, door)
            ) {
              watergirlAtDoor = true;
            }
          }

          if (
            fireboyAtDoor &&
            watergirlAtDoor &&
            this.gems.collected >= this.gems.total
          ) {
            this.gameOver("Level Complete! Well done!");
          }
        }

        gameOver(message) {
          this.gameRunning = false;
          document.getElementById("game-status").textContent = message;
        }

        updateUI() {
          document.getElementById("level").textContent = this.level;
          document.getElementById(
            "gems"
          ).textContent = `${this.gems.collected}/${this.gems.total}`;
          document.getElementById("flood-height").textContent =
            Math.round((this.floodHeight / 600) * 100) + "%";
        }

        render() {
          this.fireboy.style.left = this.characters.fireboy.x + "px";
          this.fireboy.style.top = this.characters.fireboy.y + "px";

          this.watergirl.style.left = this.characters.watergirl.x + "px";
          this.watergirl.style.top = this.characters.watergirl.y + "px";

          this.flood.style.height = this.floodHeight + "px";
        }

        gameLoop() {
          if (!this.gameRunning) return;

          this.updateCharacter(this.characters.fireboy, "fireboy");
          this.updateCharacter(this.characters.watergirl, "watergirl");
          this.render();

          requestAnimationFrame(() => this.gameLoop());
        }

        floodTimer() {
          if (!this.gameRunning) return;

          setTimeout(() => {
            this.floodHeight += this.floodRiseSpeed;
            this.updateUI();

            if (this.floodHeight < 400) {
              // Don't flood too high
              this.floodTimer();
            }
          }, 100);
        }

        restart() {
          this.gameRunning = true;
          this.gems.collected = 0;
          this.floodHeight = 0;

          this.characters.fireboy = {
            x: 50,
            y: 520,
            width: 32,
            height: 32,
            onGround: false,
            velY: 0,
          };
          this.characters.watergirl = {
            x: 100,
            y: 520,
            width: 32,
            height: 32,
            onGround: false,
            velY: 0,
          };

          document.getElementById("game-status").textContent = "";
          this.createLevel();
          this.updateUI();
          this.gameLoop();
        }
      }

      // Start the game
      window.addEventListener("load", () => {
        new Game();
      });
    </script>
  </body>
</html>
